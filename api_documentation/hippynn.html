

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hippynn &mdash; hippynn 0+unknown documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=66b59bf7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=e3456cac" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=c9d3d048"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="custom_kernels" href="hippynn.custom_kernels.html" />
    <link rel="prev" title="Hyperparameter optimization with Ax and Ray" href="../examples/hyperopt.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            hippynn
          </a>
              <div class="version">
                0+unknown
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../what_is_hippynn.html">What is hippynn?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">How to install hippynn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Research articles using hippynn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/features.html">hippynn Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/concepts.html">hippynn Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/databases.html">Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/loss_graph.html">Model and Loss Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/units.html">Units in hippynn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/ckernels.html">Custom Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/settings.html">Library Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/custom_nodes.html">Creating Custom Node Types</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/minimal_workflow.html">Minimal Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/controller.html">Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/plotting.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/predictor.html">Predictor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/ensembles.html">Ensembling Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/periodic.html">Periodic Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/forces.html">Force Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/restarting.html">Restarting training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/ase_calculator.html">ASE Calculators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/mliap_unified.html">LAMMPS interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/excited_states.html">Non-Adiabiatic Excited States</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/weighted_loss.html">Weighted/Masked Loss Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/lightning.html">Pytorch Lightning module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/hyperopt.html">Hyperparameter optimization with Ax and Ray</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Full API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.settings"><code class="docutils literal notranslate"><span class="pre">settings</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.Database"><code class="docutils literal notranslate"><span class="pre">Database</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.add_split_masks"><code class="docutils literal notranslate"><span class="pre">Database.add_split_masks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.get_device"><code class="docutils literal notranslate"><span class="pre">Database.get_device()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.make_automatic_splits"><code class="docutils literal notranslate"><span class="pre">Database.make_automatic_splits()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.make_database_cache"><code class="docutils literal notranslate"><span class="pre">Database.make_database_cache()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.make_explicit_split"><code class="docutils literal notranslate"><span class="pre">Database.make_explicit_split()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.make_explicit_split_bool"><code class="docutils literal notranslate"><span class="pre">Database.make_explicit_split_bool()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.make_generator"><code class="docutils literal notranslate"><span class="pre">Database.make_generator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.make_random_split"><code class="docutils literal notranslate"><span class="pre">Database.make_random_split()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.make_trainvalidtest_split"><code class="docutils literal notranslate"><span class="pre">Database.make_trainvalidtest_split()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.remove_high_property"><code class="docutils literal notranslate"><span class="pre">Database.remove_high_property()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.send_to_device"><code class="docutils literal notranslate"><span class="pre">Database.send_to_device()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.sort_by_index"><code class="docutils literal notranslate"><span class="pre">Database.sort_by_index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.split_the_rest"><code class="docutils literal notranslate"><span class="pre">Database.split_the_rest()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.trim_by_species"><code class="docutils literal notranslate"><span class="pre">Database.trim_by_species()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.write_h5"><code class="docutils literal notranslate"><span class="pre">Database.write_h5()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.write_npz"><code class="docutils literal notranslate"><span class="pre">Database.write_npz()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Database.var_list"><code class="docutils literal notranslate"><span class="pre">Database.var_list</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.DirectoryDatabase"><code class="docutils literal notranslate"><span class="pre">DirectoryDatabase</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.DirectoryDatabase.get_file_dict"><code class="docutils literal notranslate"><span class="pre">DirectoryDatabase.get_file_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.DirectoryDatabase.load_arrays"><code class="docutils literal notranslate"><span class="pre">DirectoryDatabase.load_arrays()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.GraphModule"><code class="docutils literal notranslate"><span class="pre">GraphModule</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.GraphModule.extra_repr"><code class="docutils literal notranslate"><span class="pre">GraphModule.extra_repr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.GraphModule.forward"><code class="docutils literal notranslate"><span class="pre">GraphModule.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.GraphModule.get_module"><code class="docutils literal notranslate"><span class="pre">GraphModule.get_module()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.GraphModule.node_from_name"><code class="docutils literal notranslate"><span class="pre">GraphModule.node_from_name()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.GraphModule.print_structure"><code class="docutils literal notranslate"><span class="pre">GraphModule.print_structure()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.IdxType"><code class="docutils literal notranslate"><span class="pre">IdxType</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.IdxType.Atoms"><code class="docutils literal notranslate"><span class="pre">IdxType.Atoms</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.IdxType.MolAtom"><code class="docutils literal notranslate"><span class="pre">IdxType.MolAtom</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.IdxType.MolAtomAtom"><code class="docutils literal notranslate"><span class="pre">IdxType.MolAtomAtom</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.IdxType.Molecules"><code class="docutils literal notranslate"><span class="pre">IdxType.Molecules</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.IdxType.NotFound"><code class="docutils literal notranslate"><span class="pre">IdxType.NotFound</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.IdxType.Pair"><code class="docutils literal notranslate"><span class="pre">IdxType.Pair</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.IdxType.QuadMol"><code class="docutils literal notranslate"><span class="pre">IdxType.QuadMol</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.IdxType.QuadPack"><code class="docutils literal notranslate"><span class="pre">IdxType.QuadPack</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.IdxType.Scalar"><code class="docutils literal notranslate"><span class="pre">IdxType.Scalar</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.NPZDatabase"><code class="docutils literal notranslate"><span class="pre">NPZDatabase</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.NPZDatabase.load_arrays"><code class="docutils literal notranslate"><span class="pre">NPZDatabase.load_arrays()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.Predictor"><code class="docutils literal notranslate"><span class="pre">Predictor</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Predictor.add_output"><code class="docutils literal notranslate"><span class="pre">Predictor.add_output()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Predictor.apply_to_database"><code class="docutils literal notranslate"><span class="pre">Predictor.apply_to_database()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Predictor.from_graph"><code class="docutils literal notranslate"><span class="pre">Predictor.from_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Predictor.predict_all"><code class="docutils literal notranslate"><span class="pre">Predictor.predict_all()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Predictor.predict_batched"><code class="docutils literal notranslate"><span class="pre">Predictor.predict_batched()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Predictor.to"><code class="docutils literal notranslate"><span class="pre">Predictor.to()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Predictor.wrap_outputs"><code class="docutils literal notranslate"><span class="pre">Predictor.wrap_outputs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Predictor.inputs"><code class="docutils literal notranslate"><span class="pre">Predictor.inputs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Predictor.model_device"><code class="docutils literal notranslate"><span class="pre">Predictor.model_device</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hippynn.Predictor.outputs"><code class="docutils literal notranslate"><span class="pre">Predictor.outputs</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.active_directory"><code class="docutils literal notranslate"><span class="pre">active_directory()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.hierarchical_energy_initialization"><code class="docutils literal notranslate"><span class="pre">hierarchical_energy_initialization()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">load_checkpoint()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.load_checkpoint_from_cwd"><code class="docutils literal notranslate"><span class="pre">load_checkpoint_from_cwd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.load_model_from_cwd"><code class="docutils literal notranslate"><span class="pre">load_model_from_cwd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.log_terminal"><code class="docutils literal notranslate"><span class="pre">log_terminal()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.reload_settings"><code class="docutils literal notranslate"><span class="pre">reload_settings()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.set_custom_kernels"><code class="docutils literal notranslate"><span class="pre">set_custom_kernels()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.setup_and_train"><code class="docutils literal notranslate"><span class="pre">setup_and_train()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.setup_training"><code class="docutils literal notranslate"><span class="pre">setup_training()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.test_model"><code class="docutils literal notranslate"><span class="pre">test_model()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hippynn.train_model"><code class="docutils literal notranslate"><span class="pre">train_model()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.custom_kernels.html">custom_kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.databases.html">databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.experiment.html">experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.graphs.html">graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.interfaces.html">interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.layers.html">layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.molecular_dynamics.html">molecular_dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.networks.html">networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.optimizer.html">optimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.plotting.html">plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.pretraining.html">pretraining module</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.tools.html">tools module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_summary/hippynn.html">API Summary Pages</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hippynn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">hippynn</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api_documentation/hippynn.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="../examples/hyperopt.html" class="btn btn-neutral float-left" title="Hyperparameter optimization with Ax and Ray" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hippynn.custom_kernels.html" class="btn btn-neutral float-right" title="custom_kernels" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="hippynn">
<h1>hippynn<a class="headerlink" href="#hippynn" title="Link to this heading"></a></h1>
<p>Full Documentation for <code class="docutils literal notranslate"><span class="pre">hippynn</span></code> package.
<a class="reference internal" href="../api_summary/hippynn.html"><span class="doc">Click here for a summary page.</span></a></p>
<p id="module-hippynn">The hippynn python package.</p>
<dl class="py data">
<dt class="sig sig-object py" id="hippynn.settings">
<span class="sig-name descname"><span class="pre">settings</span></span><a class="headerlink" href="#hippynn.settings" title="Link to this definition"></a></dt>
<dd><p>Values for the current hippynn settings.
See <a class="reference internal" href="../user_guide/settings.html"><span class="doc">Library Settings</span></a> for a description.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hippynn.Database">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">arr_dict:</span> <span class="pre">dict[str,</span> <span class="pre">~numpy.ndarray],</span> <span class="pre">inputs:</span> <span class="pre">list[str],</span> <span class="pre">targets:</span> <span class="pre">list[str],</span> <span class="pre">seed:</span> <span class="pre">[&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'numpy.random.mtrand.RandomState'&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'tuple'&gt;],</span> <span class="pre">test_size:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">valid_size:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">num_workers:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">pin_memory:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">allow_unfound:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">auto_split:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">device:</span> <span class="pre">~torch.device</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">dataloader_kwargs:</span> <span class="pre">dict[str,</span> <span class="pre">object]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">quiet=False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for holding a pytorch dataset, splitting it, generating dataloaders, etc.”</p>
<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.add_split_masks">
<span class="sig-name descname"><span class="pre">add_split_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_to_add_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.add_split_masks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.add_split_masks" title="Link to this definition"></a></dt>
<dd><p>Add split masks to the dataset. This function is used internally before writing databases.</p>
<p>When using the dict_to_add_to parameter, this function writes numpy arrays.
When adding to self.splits, this function writes tensors.
:param dict_to_add_to: where to put the split masks. Default to self.splits.
:param split_prefix: prefix for mask names
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.get_device">
<span class="sig-name descname"><span class="pre">get_device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">device</span></span></span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.get_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.get_device" title="Link to this definition"></a></dt>
<dd><p>Determine what device the database resides on. Raises ValueError if multiple devices are encountered.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>device.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.make_automatic_splits">
<span class="sig-name descname"><span class="pre">make_automatic_splits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dry_run</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.make_automatic_splits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.make_automatic_splits" title="Link to this definition"></a></dt>
<dd><p>Split the database automatically. Since the user specifies this routine,
it fails pretty strictly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_prefix</strong> – None, use default.
If otherwise, use this prefix to determine what arrays are masks.</p></li>
<li><p><strong>dry_run</strong> – Only validate that existing split masks are correct; don’t perform splitting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.make_database_cache">
<span class="sig-name descname"><span class="pre">make_database_cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'./hippynn_db_cache.npz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">override_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="hippynn.databases.database.html#hippynn.databases.database.Database" title="hippynn.databases.database.Database"><span class="pre">Database</span></a></span></span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.make_database_cache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.make_database_cache" title="Link to this definition"></a></dt>
<dd><p>Cache the database as-is, and re-open it.</p>
<p>Useful for creating an easy restart script if the storage space is available.
The new datatbase will by default inherit the properties of this database.</p>
<p>usage:
&gt;&gt;&gt; database = database.make_database_cache()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> – where to store the database</p></li>
<li><p><strong>overwrite</strong> – whether to overwrite an existing cache file with this name.</p></li>
<li><p><strong>override_kwargs</strong> – passed to NPZDictionary instead of the current database settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The new database created from the cache.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.make_explicit_split">
<span class="sig-name descname"><span class="pre">make_explicit_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.make_explicit_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.make_explicit_split" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_name</strong> – name for split, typically ‘train’, ‘valid’, ‘test’</p></li>
<li><p><strong>split_indices</strong> – the indices of the items for the split</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.make_explicit_split_bool">
<span class="sig-name descname"><span class="pre">make_explicit_split_bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.make_explicit_split_bool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.make_explicit_split_bool" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_name</strong> – name for split, typically ‘train’, ‘valid’, ‘test’</p></li>
<li><p><strong>split_mask</strong> – a boolean array for where to split</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.make_generator">
<span class="sig-name descname"><span class="pre">make_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.make_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.make_generator" title="Link to this definition"></a></dt>
<dd><p>Makes a dataloader for the given type of split and evaluation mode of the model.</p>
<p>In most cases, you do not need to call this function directly as a user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_name</strong> – str; “train”, “valid”, or “test” ; selects data to use</p></li>
<li><p><strong>evaluation_mode</strong> – str; “train” or “eval”. Used for whether to shuffle.</p></li>
<li><p><strong>batch_size</strong> – passed to pytorch</p></li>
<li><p><strong>subsample</strong> – fraction to subsample</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dataloader containing relevant data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.make_random_split">
<span class="sig-name descname"><span class="pre">make_random_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.make_random_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.make_random_split" title="Link to this definition"></a></dt>
<dd><p>Make a random split using self.random_state to select items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_name</strong> – String naming the split, can be anything, but ‘train’, ‘valid’, and ‘test’ are special.</p></li>
<li><p><strong>split_size</strong> – int (number of items) or float&lt;1, fraction of samples.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.make_trainvalidtest_split">
<span class="sig-name descname"><span class="pre">make_trainvalidtest_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.make_trainvalidtest_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.make_trainvalidtest_split" title="Link to this definition"></a></dt>
<dd><p>Make a split for train, valid, and test out of any remaining unsplit entries in the database.
The size is specified in terms of test and valid splits; the train split will be the remainder.</p>
<p>If you wish to specify precise rows for each split, see <cite>make_explict_split</cite>
or <cite>make_explicit_split_bool</cite>.</p>
<p>This function takes keyword-arguments only in order to prevent confusion over which
size is which.</p>
<p>The types of both test_size and valid_size parameters must match.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_size</strong> – int (count) or float (fraction) of data to assign to test split</p></li>
<li><p><strong>valid_size</strong> – int (count) or float (fraction) of data to assign to valid split</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.remove_high_property">
<span class="sig-name descname"><span class="pre">remove_high_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomwise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_per_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.remove_high_property"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.remove_high_property" title="Link to this definition"></a></dt>
<dd><p>For removing outliers from a dataset. Use with caution; do not inadvertently remove outliers from benchmarks!</p>
<p>The parameters cut and std_factor can be set to <cite>None</cite> to avoid their steps.
the per_atom and atom_var properties are exclusive; they cannot both be true.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – The property key in the dataset to check for high values</p></li>
<li><p><strong>atomwise</strong> – True if the property is defined per atom in axis 1, otherwise property is treated as whole-system value</p></li>
<li><p><strong>norm_per_atom</strong> – True if the property should be normalized by atom counts</p></li>
<li><p><strong>species_key</strong> – Which array represents the atom presence; required if per_atom is True</p></li>
<li><p><strong>cut</strong> – If values &gt; mu + cut, the system is removed. The step done first.</p></li>
<li><p><strong>std_factor</strong> – If (value-mu)/std &gt; std_fact, the system is trimmed. This step done second.</p></li>
<li><p><strong>norm_axis</strong> – if not None, the property array is normed on the axis. Useful for vector properties like force.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.send_to_device">
<span class="sig-name descname"><span class="pre">send_to_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.send_to_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.send_to_device" title="Link to this definition"></a></dt>
<dd><p>Move the database to an accelerator device if possible.
In some circumstances this can accelerate training.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the database is moved to a GPU,
pin_memory will be set to False
and num_workers will be set to 0.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> – device to move to, if None, try to auto-detect.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.sort_by_index">
<span class="sig-name descname"><span class="pre">sort_by_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'indices'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.sort_by_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.sort_by_index" title="Link to this definition"></a></dt>
<dd><p>Sort arrays in each split of the database by an index key.</p>
<p>The default is ‘indices’, also possible is ‘split_indices’, or any other variable name in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index_name</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.split_the_rest">
<span class="sig-name descname"><span class="pre">split_the_rest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.split_the_rest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.split_the_rest" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.trim_by_species">
<span class="sig-name descname"><span class="pre">trim_by_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_splits_same_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.trim_by_species"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.trim_by_species" title="Link to this definition"></a></dt>
<dd><p>Remove any excess padding in a database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>species_key</strong> – what array to use to mark atom presence.</p></li>
<li><p><strong>keep_splits_same_size</strong> – true: trim by the minimum amount across splits,
false:  trim by the maximum amount for each split.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.write_h5">
<span class="sig-name descname"><span class="pre">write_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h5path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'species'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.write_h5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.write_h5" title="Link to this definition"></a></dt>
<dd><p>Write this database to the pyanitools h5 format.
See <a class="reference internal" href="hippynn.databases.h5_pyanitools.html#hippynn.databases.h5_pyanitools.write_h5" title="hippynn.databases.h5_pyanitools.write_h5"><code class="xref py py-func docutils literal notranslate"><span class="pre">hippynn.databases.h5_pyanitools.write_h5()</span></code></a> for details.</p>
<p>Note: This function will error if h5py is not installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split</strong></p></li>
<li><p><strong>h5path</strong></p></li>
<li><p><strong>species_key</strong></p></li>
<li><p><strong>overwrite</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Database.write_npz">
<span class="sig-name descname"><span class="pre">write_npz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record_split_masks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compressed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/database.html#Database.write_npz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Database.write_npz" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> – str, Path, or file object compatible with np.save</p></li>
<li><p><strong>record_split_masks</strong> – whether to generate and place masks for the splits into the saved database.</p></li>
<li><p><strong>compressed</strong> – whether to use np.savez_compressed (True) or np.savez</p></li>
<li><p><strong>overwrite</strong> – Whether to accept an existing path. Only used if fname is str or path.</p></li>
<li><p><strong>split_prefix</strong> – optionally override the prefix for the masks computed by the splits.</p></li>
<li><p><strong>return_only</strong> – if True, ignore the file string and just return the resulting dictionary of numpy arrays.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hippynn.Database.var_list">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">var_list</span></span><a class="headerlink" href="#hippynn.Database.var_list" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hippynn.DirectoryDatabase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DirectoryDatabase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_unfound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/ondisk.html#DirectoryDatabase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.DirectoryDatabase" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="hippynn.databases.database.html#hippynn.databases.database.Database" title="hippynn.databases.database.Database"><code class="xref py py-class docutils literal notranslate"><span class="pre">Database</span></code></a>, <a class="reference internal" href="hippynn.databases.restarter.html#hippynn.databases.restarter.Restartable" title="hippynn.databases.restarter.Restartable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Restartable</span></code></a></p>
<p>Database stored as NPY files in a directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> – directory path where the files are stored</p></li>
<li><p><strong>name</strong> – prefix for the arrays.</p></li>
</ul>
</dd>
</dl>
<p>This function loads arrays of the format f”{name}{db_name}.npy” for each variable db_name in inputs and targets.</p>
<p>Other arguments: See <code class="docutils literal notranslate"><span class="pre">Database</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This database loader does not support the <code class="docutils literal notranslate"><span class="pre">allow_unfound</span></code> setting in the base <code class="docutils literal notranslate"><span class="pre">Database</span></code>. The
variables to load must be set explicitly in the inputs and targets.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="hippynn.DirectoryDatabase.get_file_dict">
<span class="sig-name descname"><span class="pre">get_file_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/ondisk.html#DirectoryDatabase.get_file_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.DirectoryDatabase.get_file_dict" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.DirectoryDatabase.load_arrays">
<span class="sig-name descname"><span class="pre">load_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_unfound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/ondisk.html#DirectoryDatabase.load_arrays"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.DirectoryDatabase.load_arrays" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hippynn.GraphModule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GraphModule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">required_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes_to_compute</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/graph.html#GraphModule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.GraphModule" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="hippynn.GraphModule.extra_repr">
<span class="sig-name descname"><span class="pre">extra_repr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/graph.html#GraphModule.extra_repr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.GraphModule.extra_repr" title="Link to this definition"></a></dt>
<dd><p>Set the extra representation of the module.</p>
<p>To print customized extra information, you should re-implement
this method in your own modules. Both single-line and multi-line
strings are acceptable.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.GraphModule.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">input_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/graph.html#GraphModule.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.GraphModule.forward" title="Link to this definition"></a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.GraphModule.get_module">
<span class="sig-name descname"><span class="pre">get_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/graph.html#GraphModule.get_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.GraphModule.get_module" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.GraphModule.node_from_name">
<span class="sig-name descname"><span class="pre">node_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/graph.html#GraphModule.node_from_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.GraphModule.node_from_name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.GraphModule.print_structure">
<span class="sig-name descname"><span class="pre">print_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">suppress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/graph.html#GraphModule.print_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.GraphModule.print_structure" title="Link to this definition"></a></dt>
<dd><p>Pretty-print the structure of the nodes and links comprising this graph.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hippynn.IdxType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IdxType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/indextypes/type_def.html#IdxType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.IdxType" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.IdxType.Atoms">
<span class="sig-name descname"><span class="pre">Atoms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Atoms'</span></em><a class="headerlink" href="#hippynn.IdxType.Atoms" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.IdxType.MolAtom">
<span class="sig-name descname"><span class="pre">MolAtom</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'MolAtom'</span></em><a class="headerlink" href="#hippynn.IdxType.MolAtom" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.IdxType.MolAtomAtom">
<span class="sig-name descname"><span class="pre">MolAtomAtom</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'MolAtomAtom'</span></em><a class="headerlink" href="#hippynn.IdxType.MolAtomAtom" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.IdxType.Molecules">
<span class="sig-name descname"><span class="pre">Molecules</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Molecules'</span></em><a class="headerlink" href="#hippynn.IdxType.Molecules" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.IdxType.NotFound">
<span class="sig-name descname"><span class="pre">NotFound</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'NOT</span> <span class="pre">FOUND'</span></em><a class="headerlink" href="#hippynn.IdxType.NotFound" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.IdxType.Pair">
<span class="sig-name descname"><span class="pre">Pair</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Pair'</span></em><a class="headerlink" href="#hippynn.IdxType.Pair" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.IdxType.QuadMol">
<span class="sig-name descname"><span class="pre">QuadMol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'QuadMol'</span></em><a class="headerlink" href="#hippynn.IdxType.QuadMol" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.IdxType.QuadPack">
<span class="sig-name descname"><span class="pre">QuadPack</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'QuadPack'</span></em><a class="headerlink" href="#hippynn.IdxType.QuadPack" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.IdxType.Scalar">
<span class="sig-name descname"><span class="pre">Scalar</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Scalar'</span></em><a class="headerlink" href="#hippynn.IdxType.Scalar" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hippynn.NPZDatabase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NPZDatabase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_unfound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/ondisk.html#NPZDatabase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.NPZDatabase" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="hippynn.databases.database.html#hippynn.databases.database.Database" title="hippynn.databases.database.Database"><code class="xref py py-class docutils literal notranslate"><span class="pre">Database</span></code></a>, <a class="reference internal" href="hippynn.databases.restarter.html#hippynn.databases.restarter.Restartable" title="hippynn.databases.restarter.Restartable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Restartable</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="hippynn.NPZDatabase.load_arrays">
<span class="sig-name descname"><span class="pre">load_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_unfound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/databases/ondisk.html#NPZDatabase.load_arrays"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.NPZDatabase.load_arrays" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hippynn.Predictor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Predictor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cpu')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/predictor.html#Predictor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Predictor" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The predictor is a dressed-up GraphModule which gives access
to the outputs of individual nodes.</p>
<p>In many cases you may simply want to use the <code class="docutils literal notranslate"><span class="pre">from_graph</span></code> method to generate a predictor.</p>
<p>The predictor will take the model graph, convert the output nodes into
a padded index state, and build a new graph for these operations.</p>
<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Predictor.add_output">
<span class="sig-name descname"><span class="pre">add_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/predictor.html#Predictor.add_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Predictor.add_output" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Predictor.apply_to_database">
<span class="sig-name descname"><span class="pre">apply_to_database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/predictor.html#Predictor.apply_to_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Predictor.apply_to_database" title="Link to this definition"></a></dt>
<dd><p>Note: kwargs are passed to self.__call__, e.g. the <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Predictor.from_graph">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/predictor.html#Predictor.from_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Predictor.from_graph" title="Link to this definition"></a></dt>
<dd><p>Construct a new predictor from an existing GraphModule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – graph to create predictor for. The predictor makes a shallow copy of this graph. e.g. it may move
parameters from that graph to the model_device.</p></li>
<li><p><strong>additional_outputs</strong> – List of additional nodes to include in outputs</p></li>
<li><p><strong>kwargs</strong> – passed to <code class="docutils literal notranslate"><span class="pre">__init__</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>predictor instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Predictor.predict_all">
<span class="sig-name descname"><span class="pre">predict_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/predictor.html#Predictor.predict_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Predictor.predict_all" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Predictor.predict_batched">
<span class="sig-name descname"><span class="pre">predict_batched</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/predictor.html#Predictor.predict_batched"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Predictor.predict_batched" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Predictor.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/predictor.html#Predictor.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Predictor.to" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hippynn.Predictor.wrap_outputs">
<span class="sig-name descname"><span class="pre">wrap_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/graphs/predictor.html#Predictor.wrap_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.Predictor.wrap_outputs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hippynn.Predictor.inputs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inputs</span></span><a class="headerlink" href="#hippynn.Predictor.inputs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hippynn.Predictor.model_device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model_device</span></span><a class="headerlink" href="#hippynn.Predictor.model_device" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hippynn.Predictor.outputs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">outputs</span></span><a class="headerlink" href="#hippynn.Predictor.outputs" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.active_directory">
<span class="sig-name descname"><span class="pre">active_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/tools.html#active_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.active_directory" title="Link to this definition"></a></dt>
<dd><p>Context manager for temporarily switching the current working directory.</p>
<p>If create is None, always succeed.
If create is True, only succeed if the directory does not exist, and create one.
If create is False, only succeed if the directory does exist, and switch to it.</p>
<p>In other words, use create=True if you want to force that it’s a new directory.
Use create=False if you want to switch to an existing directory.
Use create=None create a directory if you are okay with either alternative.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dirname</strong> – directory to enter</p></li>
<li><p><strong>create</strong> – (None,True,False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p>If directory status not compatible with <cite>create</cite> constraints.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.hierarchical_energy_initialization">
<span class="sig-name descname"><span class="pre">hierarchical_energy_initialization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peratom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/pretraining.html#hierarchical_energy_initialization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.hierarchical_energy_initialization" title="Link to this definition"></a></dt>
<dd><p>Computes values for the non-interacting energy using the training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>energy_module</strong> – HEnergyNode or torch module for energy prediction</p></li>
<li><p><strong>database</strong> – InterfaceDB object to get training data, required if model contains E0 term</p></li>
<li><p><strong>trainable_after</strong> – Determines if it should change .requires_grad attribute for the E0 parameters</p></li>
<li><p><strong>decay_factor</strong> – change initialized weights of further energy layers by <code class="docutils literal notranslate"><span class="pre">df**N</span></code> for layer N</p></li>
<li><p><strong>encoder</strong> – species encoder, can be auto-identified from energy node</p></li>
<li><p><strong>energy_name</strong> – name for the energy variable, can be auto-identified from energy node</p></li>
<li><p><strong>species_name</strong> – name for the species variable, can be auto-identified from energy node</p></li>
<li><p><strong>peratom</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_fname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_fname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart_db</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/hippynn/experiment/serialization.html#load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.load_checkpoint" title="Link to this definition"></a></dt>
<dd><p>Load checkpoint file from given filename.</p>
<p>For details more information on to use this function, see <a class="reference internal" href="../examples/restarting.html"><span class="doc">Restarting training</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_fname</strong> – name of the structure file</p></li>
<li><p><strong>state_fname</strong> – name of the state file</p></li>
<li><p><strong>restart_db</strong> – restore database or not, defaults to False</p></li>
<li><p><strong>map_location</strong> – device mapping argument for <code class="docutils literal notranslate"><span class="pre">torch.load</span></code>, defaults to None</p></li>
<li><p><strong>model_device</strong> – automatically handle device mapping. Defaults to None, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>experiment structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.load_checkpoint_from_cwd">
<span class="sig-name descname"><span class="pre">load_checkpoint_from_cwd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/hippynn/experiment/serialization.html#load_checkpoint_from_cwd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.load_checkpoint_from_cwd" title="Link to this definition"></a></dt>
<dd><p>Same as <code class="docutils literal notranslate"><span class="pre">load_checkpoint</span></code>, but using default filenames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map_location</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>dict</em><em>, </em><em>torch.device</em><em>, </em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – device mapping argument for <code class="docutils literal notranslate"><span class="pre">torch.load</span></code>, defaults to None</p></li>
<li><p><strong>model_device</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>str</em><em>, </em><em>torch.device</em><em>]</em><em>, </em><em>optional</em>) – automatically handle device mapping. Defaults to None, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>experiment structure</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.load_model_from_cwd">
<span class="sig-name descname"><span class="pre">load_model_from_cwd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="hippynn.graphs.graph.html#hippynn.graphs.graph.GraphModule" title="hippynn.graphs.graph.GraphModule"><span class="pre">GraphModule</span></a></span></span><a class="reference internal" href="../_modules/hippynn/experiment/serialization.html#load_model_from_cwd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.load_model_from_cwd" title="Link to this definition"></a></dt>
<dd><p>Only load model from current working directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map_location</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>dict</em><em>, </em><em>torch.device</em><em>, </em><em>Callable</em><em>]</em><em>, </em><em>optional</em>) – device mapping argument for <code class="docutils literal notranslate"><span class="pre">torch.load</span></code>, defaults to None</p></li>
<li><p><strong>model_device</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>str</em><em>, </em><em>torch.device</em><em>]</em><em>, </em><em>optional</em>) – automatically handle device mapping. Defaults to None, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>model with reloaded parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.log_terminal">
<span class="sig-name descname"><span class="pre">log_terminal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/tools.html#log_terminal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.log_terminal" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>file: filename or string</p>
</dd>
<dt class="field-even">Param<span class="colon">:</span></dt>
<dd class="field-even"><p>args:   piped to <code class="docutils literal notranslate"><span class="pre">open(file,*args,**kwargs)</span></code> if file is a string</p>
</dd>
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>kwargs: piped to <code class="docutils literal notranslate"><span class="pre">open(file,*args,**kwargs)</span></code> if file is a string</p>
</dd>
</dl>
<p>Context manager where stdout and stderr are redirected to the specified file
in addition to the usual stdout and stderr.
The manager yields the file. Writes to the opened file object with
“with log_terminal(…) as &lt;file&gt;” will not automatically
be piped into the terminal.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.reload_settings">
<span class="sig-name descname"><span class="pre">reload_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/_settings_setup.html#reload_settings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.reload_settings" title="Link to this definition"></a></dt>
<dd><p>Attempt to reload the hippynn library settings.</p>
<dl class="simple">
<dt>Settings sources are, in order from least to greatest priority:</dt><dd><ul class="simple">
<li><p>Default values</p></li>
<li><dl class="simple">
<dt>The file <cite>~/.hippynnrc</cite>, which is a standard python config file which contains</dt><dd><p>variables under the section name [GLOBALS].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>A file specified by the environment variable <cite>HIPPYNN_LOCAL_RC_FILE</cite></dt><dd><p>which is treated the same as the user rc file.</p>
</dd>
</dl>
</li>
<li><p>Environment variables prefixed by <code class="docutils literal notranslate"><span class="pre">HIPPYNN_</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">HIPPYNN_DEFAULT_PLOT_FILETYPE</span></code>.</p></li>
<li><p>Keyword arguments passed to this function.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – explicit settings to change.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.set_custom_kernels">
<span class="sig-name descname"><span class="pre">set_custom_kernels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">active</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/custom_kernels.html#set_custom_kernels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.set_custom_kernels" title="Link to this definition"></a></dt>
<dd><p>Activate or deactivate custom kernels for interaction.</p>
<dl class="simple">
<dt>This function changes the global variables:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="hippynn.custom_kernels.html#hippynn.custom_kernels.envsum" title="hippynn.custom_kernels.envsum"><code class="xref py py-func docutils literal notranslate"><span class="pre">hippynn.custom_kernels.envsum()</span></code></a></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">hippynn.custom_kernels.sensum()</span></code></p></li>
<li><p><a class="reference internal" href="hippynn.custom_kernels.html#hippynn.custom_kernels.featsum" title="hippynn.custom_kernels.featsum"><code class="xref py py-func docutils literal notranslate"><span class="pre">hippynn.custom_kernels.featsum()</span></code></a></p></li>
<li><p><a class="reference internal" href="hippynn.custom_kernels.html#hippynn.custom_kernels.CUSTOM_KERNELS_ACTIVE" title="hippynn.custom_kernels.CUSTOM_KERNELS_ACTIVE"><code class="xref py py-data docutils literal notranslate"><span class="pre">hippynn.custom_kernels.CUSTOM_KERNELS_ACTIVE</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>active</strong> – If true, set custom kernels to the best available. If False, turn them off and default to pytorch.
If “triton”, “numba” or “cupy”, use those implementations explicitly. If “auto”, use best available.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.setup_and_train">
<span class="sig-name descname"><span class="pre">setup_and_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_modules</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="hippynn.experiment.assembly.html#hippynn.experiment.assembly.TrainingModules" title="hippynn.experiment.assembly.TrainingModules"><span class="pre">TrainingModules</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="hippynn.databases.database.html#hippynn.databases.database.Database" title="hippynn.databases.database.Database"><span class="pre">Database</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">setup_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="hippynn.experiment.routines.html#hippynn.experiment.routines.SetupParams" title="hippynn.experiment.routines.SetupParams"><span class="pre">SetupParams</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_all_better</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_best</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_every</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/experiment/routines.html#setup_and_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.setup_and_train" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>training_modules: see <a class="reference internal" href="#hippynn.setup_training" title="hippynn.setup_training"><code class="xref py py-func docutils literal notranslate"><span class="pre">setup_training()</span></code></a></p>
</dd>
<dt class="field-even">Param<span class="colon">:</span></dt>
<dd class="field-even"><p>database: see <a class="reference internal" href="#hippynn.train_model" title="hippynn.train_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">train_model()</span></code></a></p>
</dd>
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>setup_params: see <a class="reference internal" href="#hippynn.setup_training" title="hippynn.setup_training"><code class="xref py py-func docutils literal notranslate"><span class="pre">setup_training()</span></code></a></p>
</dd>
<dt class="field-even">Param<span class="colon">:</span></dt>
<dd class="field-even"><p>store_all_better: Save the state dict for each model doing better than a previous one</p>
</dd>
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>store_best: Save a checkpoint for the best model</p>
</dd>
<dt class="field-even">Param<span class="colon">:</span></dt>
<dd class="field-even"><p>store_every: Save a checkpoint for every certain epochs</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>See <a class="reference internal" href="#hippynn.train_model" title="hippynn.train_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">train_model()</span></code></a></p>
</dd>
</dl>
<p>Shortcut for setup_training followed by train_model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The training loop will capture KeyboardInterrupt exceptions to abort the experiment early.
If you would like to gracefully kill training programmatically, see <a class="reference internal" href="#hippynn.train_model" title="hippynn.train_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">train_model()</span></code></a> with callbacks argument.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Saves files in the current running directory; recommend you switch
to a fresh directory with a descriptive name for your experiment.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.setup_training">
<span class="sig-name descname"><span class="pre">setup_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_modules</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="hippynn.experiment.assembly.html#hippynn.experiment.assembly.TrainingModules" title="hippynn.experiment.assembly.TrainingModules"><span class="pre">TrainingModules</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">setup_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="hippynn.experiment.routines.html#hippynn.experiment.routines.SetupParams" title="hippynn.experiment.routines.SetupParams"><span class="pre">SetupParams</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/experiment/routines.html#setup_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.setup_training" title="Link to this definition"></a></dt>
<dd><p>Prepares training_modules for training with experiment_params.</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>training_modules: Tuple of model, training loss, and evaluation losses
(Can be built from graph using <cite>graphs.assemble_training_modules</cite>)</p>
</dd>
<dt class="field-even">Param<span class="colon">:</span></dt>
<dd class="field-even"><p>setup_params: parameters controlling how training is performed
(See <code class="xref py py-class docutils literal notranslate"><span class="pre">SetupParams</span></code>)</p>
</dd>
</dl>
<p>Roughly:</p>
<ul>
<li><p>sets devices for training modules</p></li>
<li><p>if no controller given:</p>
<blockquote>
<div><ul class="simple">
<li><p>instantiates and links optimizer to the learnable params on the model</p></li>
<li><p>instantiates and links scheduler to optimizer</p></li>
<li><p>builds a default controller with setup params</p></li>
</ul>
</div></blockquote>
</li>
<li><p>creates a MetricTracker for storing the training metrics</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(optimizer,evaluator,controller,metrics,callbacks)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.test_model">
<span class="sig-name descname"><span class="pre">test_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">when</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_tracker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/experiment/routines.html#test_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.test_model" title="Link to this definition"></a></dt>
<dd><p>Tests the model on the database according to the model_evaluator metrics.
If a plot_maker is attached to the model evaluator, it will make plots.
The plots will go in a sub-folder specified by <cite>when</cite> the testing is taking place.
The results are then printed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>database</strong> – The database test the model on.</p></li>
<li><p><strong>evaluator</strong> – The evaluator containing model and evaluation losses to measure.</p></li>
<li><p><strong>when</strong> – A string to specify what plots are currently to be used.</p></li>
<li><p><strong>metric_tracker</strong> – (Optional) metric tracker to save metrics on. If not provided,
a blank one will be constructed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>metric tracker</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.train_model">
<span class="sig-name descname"><span class="pre">train_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_modules</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">controller</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_tracker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_callbacks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_all_better</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_best</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_every</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_structure_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/experiment/routines.html#train_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.train_model" title="Link to this definition"></a></dt>
<dd><p>Performs training loop, allows keyboard interrupt. When done,
reinstate the best model, make plots and metrics over time, and test the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>training_modules</strong> – tuple-like of model, loss, and evaluator</p></li>
<li><p><strong>database</strong> – Database</p></li>
<li><p><strong>controller</strong> – Controller</p></li>
<li><p><strong>metric_tracker</strong> – MetricTracker for storing model performance</p></li>
<li><p><strong>callbacks</strong> – callbacks to perform after every epoch.</p></li>
<li><p><strong>batch_callbacks</strong> – callbacks to perform after every batch</p></li>
<li><p><strong>store_best</strong> – Save a checkpoint for the best model</p></li>
<li><p><strong>store_all_better</strong> – Save the state dict for each model doing better than a previous one</p></li>
<li><p><strong>store_every</strong> – Save a checkpoint for every certain epochs</p></li>
<li><p><strong>store_structure_file</strong> – Save the structure file for this experiment</p></li>
<li><p><strong>store_metrics</strong> – Save the metric tracker for this experiment.</p></li>
<li><p><strong>quiet</strong> – If True, disable printing during training (still prints testing results).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>metric_tracker</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>callbacks take the form of an iterable of callables
and will be called with cb(epoch,new_best)</p>
<ul class="simple">
<li><p>epoch indicates the epoch number</p></li>
<li><p>new_best indicates if the model is a new best model</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>batch_callbacks take the form of an  iterable of callables
and will each be called with cb(batch_inputs, batch_model_outputs, batch_targets)</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may want to make your callbacks store other state, if so, an easy way is to make them a callable object.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>callback state is not managed by <code class="docutils literal notranslate"><span class="pre">hippynn</span></code>. If your wish to save or load callback state, you will
have to manage that manually (possibly with a callback itself).</p>
</div>
</dd></dl>

<p>Subpackages</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="hippynn.custom_kernels.html">custom_kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="hippynn.databases.html">databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="hippynn.experiment.html">experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="hippynn.graphs.html">graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="hippynn.interfaces.html">interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="hippynn.layers.html">layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="hippynn.molecular_dynamics.html">molecular_dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="hippynn.networks.html">networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="hippynn.optimizer.html">optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="hippynn.plotting.html">plotting</a></li>
</ul>
</div>
<p>Submodules</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="hippynn.pretraining.html">pretraining module</a></li>
<li class="toctree-l1"><a class="reference internal" href="hippynn.tools.html">tools module</a></li>
</ul>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../examples/hyperopt.html" class="btn btn-neutral float-left" title="Hyperparameter optimization with Ax and Ray" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hippynn.custom_kernels.html" class="btn btn-neutral float-right" title="custom_kernels" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Los Alamos National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>