<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>step_functions module &mdash; hippynn 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=e3456cac" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=8df938ec"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="graphs package" href="hippynn.graphs.html" />
    <link rel="prev" title="serialization module" href="hippynn.experiment.serialization.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            hippynn
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">How to install hippynn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="hippynn.html">hippynn API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hippynn.custom_kernels.html">custom_kernels package</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.databases.html">databases package</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="hippynn.experiment.html">experiment package</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.SetupParams"><code class="docutils literal notranslate"><span class="pre">SetupParams</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.assemble_for_training"><code class="docutils literal notranslate"><span class="pre">assemble_for_training()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.setup_and_train"><code class="docutils literal notranslate"><span class="pre">setup_and_train()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.setup_training"><code class="docutils literal notranslate"><span class="pre">setup_training()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.test_model"><code class="docutils literal notranslate"><span class="pre">test_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.train_model"><code class="docutils literal notranslate"><span class="pre">train_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.assembly.html">assembly module</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.controllers.html">controllers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.device.html">device module</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.evaluator.html">evaluator module</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.metric_tracker.html">metric_tracker module</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.routines.html">routines module</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.experiment.serialization.html">serialization module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">step_functions module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hippynn.experiment.step_functions.ClosureStep"><code class="docutils literal notranslate"><span class="pre">ClosureStep</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#hippynn.experiment.step_functions.ClosureStep.step"><code class="docutils literal notranslate"><span class="pre">ClosureStep.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#hippynn.experiment.step_functions.StandardStep"><code class="docutils literal notranslate"><span class="pre">StandardStep</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#hippynn.experiment.step_functions.StandardStep.step"><code class="docutils literal notranslate"><span class="pre">StandardStep.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#hippynn.experiment.step_functions.StepFn"><code class="docutils literal notranslate"><span class="pre">StepFn</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#hippynn.experiment.step_functions.StepFn.step"><code class="docutils literal notranslate"><span class="pre">StepFn.step</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#hippynn.experiment.step_functions.TwoStep"><code class="docutils literal notranslate"><span class="pre">TwoStep</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#hippynn.experiment.step_functions.TwoStep.step"><code class="docutils literal notranslate"><span class="pre">TwoStep.step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#hippynn.experiment.step_functions.closure_step_fn"><code class="docutils literal notranslate"><span class="pre">closure_step_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hippynn.experiment.step_functions.get_step_function"><code class="docutils literal notranslate"><span class="pre">get_step_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hippynn.experiment.step_functions.standard_step_fn"><code class="docutils literal notranslate"><span class="pre">standard_step_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hippynn.experiment.step_functions.twostep_step_fn"><code class="docutils literal notranslate"><span class="pre">twostep_step_fn()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.graphs.html">graphs package</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.interfaces.html">interfaces package</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.layers.html">layers package</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.networks.html">networks package</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.plotting.html">plotting package</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.pretraining.html">pretraining module</a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.tools.html">tools module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hippynn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="hippynn.html">hippynn package</a></li>
          <li class="breadcrumb-item"><a href="hippynn.experiment.html">experiment package</a></li>
      <li class="breadcrumb-item active">step_functions module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api_documentation/hippynn.experiment.step_functions.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="hippynn.experiment.serialization.html" class="btn btn-neutral float-left" title="serialization module" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hippynn.graphs.html" class="btn btn-neutral float-right" title="graphs package" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="step-functions-module">
<h1>step_functions module<a class="headerlink" href="#step-functions-module" title="Permalink to this heading"></a></h1>
<p>Documentation for <code class="docutils literal notranslate"><span class="pre">hippynn.experiment.step_functions</span></code> module.</p>
<span class="target" id="module-hippynn.experiment.step_functions"></span><p>This file implements various stepping protocols used by different optimizer APIs.</p>
<dl class="simple">
<dt>In particular:</dt><dd><ul class="simple">
<li><p>The “standard” step function which only requires that backwards has been called.</p></li>
<li><p>The “closure” step function for when line search is required (currently only active on LBFGS)</p></li>
<li><p>The “two step” style of Sharpness Aware Minimization algorithms</p></li>
</ul>
</dd>
</dl>
<p>The main output function here is <cite>get_step_function(optimizer)-&gt; callable</cite>.</p>
<p>The various step functions are provided as classes that act with staticmethods.
This is to provide for the possibility of extension, for example, to schemes with
stepping schemes that require additional state, or for the possibility to specifiy
the step function explicitly within the controller.</p>
<dl class="py class">
<dt class="sig sig-object py" id="hippynn.experiment.step_functions.ClosureStep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ClosureStep</span></span><a class="reference internal" href="../_modules/hippynn/experiment/step_functions.html#ClosureStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.step_functions.ClosureStep" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#hippynn.experiment.step_functions.StepFn" title="hippynn.experiment.step_functions.StepFn"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepFn</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="hippynn.experiment.step_functions.ClosureStep.step">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_targets</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hippynn.experiment.step_functions.ClosureStep.step" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hippynn.experiment.step_functions.StandardStep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StandardStep</span></span><a class="reference internal" href="../_modules/hippynn/experiment/step_functions.html#StandardStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.step_functions.StandardStep" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#hippynn.experiment.step_functions.StepFn" title="hippynn.experiment.step_functions.StepFn"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepFn</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="hippynn.experiment.step_functions.StandardStep.step">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_targets</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hippynn.experiment.step_functions.StandardStep.step" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hippynn.experiment.step_functions.StepFn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StepFn</span></span><a class="reference internal" href="../_modules/hippynn/experiment/step_functions.html#StepFn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.step_functions.StepFn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.experiment.step_functions.StepFn.step">
<span class="sig-name descname"><span class="pre">step</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">NotImplemented</span></em><a class="headerlink" href="#hippynn.experiment.step_functions.StepFn.step" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hippynn.experiment.step_functions.TwoStep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TwoStep</span></span><a class="reference internal" href="../_modules/hippynn/experiment/step_functions.html#TwoStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.step_functions.TwoStep" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#hippynn.experiment.step_functions.StepFn" title="hippynn.experiment.step_functions.StepFn"><code class="xref py py-class docutils literal notranslate"><span class="pre">StepFn</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="hippynn.experiment.step_functions.TwoStep.step">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_targets</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hippynn.experiment.step_functions.TwoStep.step" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.experiment.step_functions.closure_step_fn">
<span class="sig-name descname"><span class="pre">closure_step_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/experiment/step_functions.html#closure_step_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.step_functions.closure_step_fn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.experiment.step_functions.get_step_function">
<span class="sig-name descname"><span class="pre">get_step_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">callable</span></span></span><a class="reference internal" href="../_modules/hippynn/experiment/step_functions.html#get_step_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.step_functions.get_step_function" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.experiment.step_functions.standard_step_fn">
<span class="sig-name descname"><span class="pre">standard_step_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/experiment/step_functions.html#standard_step_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.step_functions.standard_step_fn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.experiment.step_functions.twostep_step_fn">
<span class="sig-name descname"><span class="pre">twostep_step_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/experiment/step_functions.html#twostep_step_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.step_functions.twostep_step_fn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hippynn.experiment.serialization.html" class="btn btn-neutral float-left" title="serialization module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hippynn.graphs.html" class="btn btn-neutral float-right" title="graphs package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Los Alamos National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>