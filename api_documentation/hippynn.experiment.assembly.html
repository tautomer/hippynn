<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hippynn.experiment.assembly module &mdash; hippynn 0+unknown documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=e3456cac" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=c9d3d048"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="hippynn.experiment.controllers module" href="hippynn.experiment.controllers.html" />
    <link rel="prev" title="hippynn.experiment package" href="hippynn.experiment.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            hippynn
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">How to install hippynn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="hippynn.html">hippynn API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.settings"><code class="docutils literal notranslate"><span class="pre">settings</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.active_directory"><code class="docutils literal notranslate"><span class="pre">active_directory()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.hierarchical_energy_initialization"><code class="docutils literal notranslate"><span class="pre">hierarchical_energy_initialization()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">load_checkpoint()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.load_checkpoint_from_cwd"><code class="docutils literal notranslate"><span class="pre">load_checkpoint_from_cwd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.load_model_from_cwd"><code class="docutils literal notranslate"><span class="pre">load_model_from_cwd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.log_terminal"><code class="docutils literal notranslate"><span class="pre">log_terminal()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.reload_settings"><code class="docutils literal notranslate"><span class="pre">reload_settings()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.set_custom_kernels"><code class="docutils literal notranslate"><span class="pre">set_custom_kernels()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.setup_and_train"><code class="docutils literal notranslate"><span class="pre">setup_and_train()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.setup_training"><code class="docutils literal notranslate"><span class="pre">setup_training()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.test_model"><code class="docutils literal notranslate"><span class="pre">test_model()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.train_model"><code class="docutils literal notranslate"><span class="pre">train_model()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.Database"><code class="docutils literal notranslate"><span class="pre">Database</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.DirectoryDatabase"><code class="docutils literal notranslate"><span class="pre">DirectoryDatabase</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.GraphModule"><code class="docutils literal notranslate"><span class="pre">GraphModule</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.IdxType"><code class="docutils literal notranslate"><span class="pre">IdxType</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.NPZDatabase"><code class="docutils literal notranslate"><span class="pre">NPZDatabase</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#hippynn.Predictor"><code class="docutils literal notranslate"><span class="pre">Predictor</span></code></a></li>
<li class="toctree-l2 current"><a class="reference internal" href="hippynn.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hippynn.custom_kernels.html">hippynn.custom_kernels package</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.databases.html">hippynn.databases package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="hippynn.experiment.html">hippynn.experiment package</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.assemble_for_training"><code class="docutils literal notranslate"><span class="pre">assemble_for_training()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.setup_and_train"><code class="docutils literal notranslate"><span class="pre">setup_and_train()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.setup_training"><code class="docutils literal notranslate"><span class="pre">setup_training()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.train_model"><code class="docutils literal notranslate"><span class="pre">train_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.test_model"><code class="docutils literal notranslate"><span class="pre">test_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.SetupParams"><code class="docutils literal notranslate"><span class="pre">SetupParams</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.load_checkpoint"><code class="docutils literal notranslate"><span class="pre">load_checkpoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.load_checkpoint_from_cwd"><code class="docutils literal notranslate"><span class="pre">load_checkpoint_from_cwd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="hippynn.experiment.html#hippynn.experiment.load_model_from_cwd"><code class="docutils literal notranslate"><span class="pre">load_model_from_cwd()</span></code></a></li>
<li class="toctree-l4 current"><a class="reference internal" href="hippynn.experiment.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l5 current"><a class="current reference internal" href="#">hippynn.experiment.assembly module</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#hippynn.experiment.assembly.TrainingModules"><code class="docutils literal notranslate"><span class="pre">TrainingModules</span></code></a><ul>
<li class="toctree-l7"><a class="reference internal" href="#hippynn.experiment.assembly.TrainingModules.evaluator"><code class="docutils literal notranslate"><span class="pre">TrainingModules.evaluator</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#hippynn.experiment.assembly.TrainingModules.loss"><code class="docutils literal notranslate"><span class="pre">TrainingModules.loss</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#hippynn.experiment.assembly.TrainingModules.model"><code class="docutils literal notranslate"><span class="pre">TrainingModules.model</span></code></a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#hippynn.experiment.assembly.generate_database_info"><code class="docutils literal notranslate"><span class="pre">generate_database_info()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#hippynn.experiment.assembly.build_loss_modules"><code class="docutils literal notranslate"><span class="pre">build_loss_modules()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#hippynn.experiment.assembly.determine_out_in_targ"><code class="docutils literal notranslate"><span class="pre">determine_out_in_targ()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#hippynn.experiment.assembly.assemble_for_training"><code class="docutils literal notranslate"><span class="pre">assemble_for_training()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#hippynn.experiment.assembly.precompute_pairs"><code class="docutils literal notranslate"><span class="pre">precompute_pairs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="hippynn.experiment.controllers.html">hippynn.experiment.controllers module</a></li>
<li class="toctree-l5"><a class="reference internal" href="hippynn.experiment.device.html">hippynn.experiment.device module</a></li>
<li class="toctree-l5"><a class="reference internal" href="hippynn.experiment.evaluator.html">hippynn.experiment.evaluator module</a></li>
<li class="toctree-l5"><a class="reference internal" href="hippynn.experiment.lightning_trainer.html">hippynn.experiment.lightning_trainer module</a></li>
<li class="toctree-l5"><a class="reference internal" href="hippynn.experiment.metric_tracker.html">hippynn.experiment.metric_tracker module</a></li>
<li class="toctree-l5"><a class="reference internal" href="hippynn.experiment.routines.html">hippynn.experiment.routines module</a></li>
<li class="toctree-l5"><a class="reference internal" href="hippynn.experiment.serialization.html">hippynn.experiment.serialization module</a></li>
<li class="toctree-l5"><a class="reference internal" href="hippynn.experiment.step_functions.html">hippynn.experiment.step_functions module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.graphs.html">hippynn.graphs package</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.interfaces.html">hippynn.interfaces package</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.layers.html">hippynn.layers package</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.molecular_dynamics.html">hippynn.molecular_dynamics package</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.networks.html">hippynn.networks package</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.optimizer.html">hippynn.optimizer package</a></li>
<li class="toctree-l3"><a class="reference internal" href="hippynn.plotting.html">hippynn.plotting package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hippynn.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hippynn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="hippynn.html">hippynn package</a></li>
          <li class="breadcrumb-item"><a href="hippynn.experiment.html">hippynn.experiment package</a></li>
      <li class="breadcrumb-item active">hippynn.experiment.assembly module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api_documentation/hippynn.experiment.assembly.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="hippynn.experiment.html" class="btn btn-neutral float-left" title="hippynn.experiment package" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hippynn.experiment.controllers.html" class="btn btn-neutral float-right" title="hippynn.experiment.controllers module" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-hippynn.experiment.assembly">
<span id="hippynn-experiment-assembly-module"></span><h1>hippynn.experiment.assembly module<a class="headerlink" href="#module-hippynn.experiment.assembly" title="Link to this heading"></a></h1>
<p>Assembling graphs for a training run</p>
<dl class="py class">
<dt class="sig sig-object py" id="hippynn.experiment.assembly.TrainingModules">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TrainingModules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hippynn.experiment.assembly.TrainingModules" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – assembled torch.nn.Module of the model</p></li>
<li><p><strong>loss</strong> – assembled torch.nn.Module for the loss</p></li>
<li><p><strong>evaluator</strong> – assembled evaluator for validation losses</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.experiment.assembly.TrainingModules.evaluator">
<span class="sig-name descname"><span class="pre">evaluator</span></span><a class="headerlink" href="#hippynn.experiment.assembly.TrainingModules.evaluator" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.experiment.assembly.TrainingModules.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><a class="headerlink" href="#hippynn.experiment.assembly.TrainingModules.loss" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hippynn.experiment.assembly.TrainingModules.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#hippynn.experiment.assembly.TrainingModules.model" title="Link to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.experiment.assembly.generate_database_info">
<span class="sig-name descname"><span class="pre">generate_database_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_unfound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/experiment/assembly.html#generate_database_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.assembly.generate_database_info" title="Link to this definition"></a></dt>
<dd><p>Construct db info from input nodes and target nodes.
:param inputs: list of input nodes
:param targets: list of target nodes
:param allow_unfound: don’t check if names are valid</p>
<p>Builds a list of the db names for the nodes.
If</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.experiment.assembly.build_loss_modules">
<span class="sig-name descname"><span class="pre">build_loss_modules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network_outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database_inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/experiment/assembly.html#build_loss_modules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.assembly.build_loss_modules" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.experiment.assembly.determine_out_in_targ">
<span class="sig-name descname"><span class="pre">determine_out_in_targ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">nodes_required_for_loss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/experiment/assembly.html#determine_out_in_targ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.assembly.determine_out_in_targ" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nodes_required_for_loss</strong> – train nodes and validation nodes</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>lists of needed network inputs, network outputs, and database targets</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.experiment.assembly.assemble_for_training">
<span class="sig-name descname"><span class="pre">assemble_for_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_maker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/experiment/assembly.html#assemble_for_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.assembly.assemble_for_training" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loss</strong> – LossNode</p></li>
<li><p><strong>validation_losses</strong> – dict of (name:loss_node) or list of LossNodes.
-if a list of loss nodes, the name of the node will be used for printing the loss,
-this can be overwritten with a list of validation_names</p></li>
<li><p><strong>(</strong><strong>optional</strong><strong>)</strong> (<em>validation_names</em>) – list of names for loss nodes, only if validation_losses is a list.</p></li>
<li><p><strong>plot_maker</strong> – optional PlotMaker for model evaluation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>training_modules, db_info
-db_info: dict of inputs (input to model) and targets (input to loss) in terms of the <cite>db_name</cite>.</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">assemble_for_training</span></code> computes:</p>
<ol class="arabic simple">
<li><p>what inputs are needed to the model</p></li>
<li><p>what outputs of the model are needed for the loss</p></li>
<li><p>what targets are needed from the database for the loss</p></li>
</ol>
<p>It then uses this info to create <code class="docutils literal notranslate"><span class="pre">GraphModule</span></code> s for the model and loss,
and an <code class="docutils literal notranslate"><span class="pre">Evaluator</span></code> based on validation loss (&amp; names), early stopping, plot maker.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Model and training loss are always evaluated on the active device.
But the validation losses reside by default on the CPU. This helps compute statistics over large datasets.
To accomplish this, the modules associated with the loss are copied in the validation loss.
Thus, after assembling the modules for training, changes to the loss nodes will not affect the model evaluator.
In all likelihood you aren’t planning to do something too fancy like change the loss nodes during training.
But if you do plan to do something like that with callbacks, know that you would probably need to construct a new
evaluator.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hippynn.experiment.assembly.precompute_pairs">
<span class="sig-name descname"><span class="pre">precompute_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_dense</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/hippynn/experiment/assembly.html#precompute_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hippynn.experiment.assembly.precompute_pairs" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Assembled GraphModule involving a PairIndexer</p></li>
<li><p><strong>database</strong> – database that precomputation should be supplied with</p></li>
<li><p><strong>batch_size</strong> – batch size to do pre-computation with</p></li>
<li><p><strong>device</strong> – where to do the precomputation.</p></li>
<li><p><strong>make_dense</strong> – return a dense array of pairs. Warning, this can be memory-expensive. However, it is necessary if you
are going to use num_workers&gt;0 in your dataloaders. If False, the cache is stored as a sparse array.</p></li>
<li><p><strong>n_images</strong> – number of images for cache storage, increase this if it fails.
However, large values can incur a large memory cost if make_dense is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None– changes the model graph.</p>
</dd>
</dl>
<p>Note that the returned model needs to be re-assembled with the new graph for the cache to take effect.
Example usage:
&gt;&gt;&gt; precompute_pairs(training_modules.model,database,device=’cuda’)
&gt;&gt;&gt; training_modules, db_info = assemble_for_training(train_loss, validation_losses)
&gt;&gt;&gt; database.inputs = db_info[‘inputs’]</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hippynn.experiment.html" class="btn btn-neutral float-left" title="hippynn.experiment package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hippynn.experiment.controllers.html" class="btn btn-neutral float-right" title="hippynn.experiment.controllers module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Los Alamos National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>